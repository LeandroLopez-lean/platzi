(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["71"],{"1183":function(e,t,n){"use strict";var r,i=n(259),s={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(s)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.e=r},"1742":function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});n.d(t,"n",function(){return f});var r,i=n(82),s=n(45),o=new i.e("NPSMetadata",s.e.local);(function(e){e[e.QueryOpen=0]="QueryOpen";e[e.OpenAction=1]="OpenAction";e[e.ShareAction=2]="ShareAction";e[e.SyncAction=3]="SyncAction";e[e.MoveAction=4]="MoveAction";e[e.CopyAction=5]="CopyAction";e[e.SharedLibraryClick=6]="SharedLibraryClick";e[e.CreateSharedLibrary=7]="CreateSharedLibrary";e[e.DownloadAction=8]="DownloadAction";e[e.DeleteAction=9]="DeleteAction";e[e.PhotoTabClick=10]="PhotoTabClick"})(r||(r={}));function u(){return o.getValue("NPSMetadataBeforeSurvey")}function a(e){return e?r[Number(e)]:""}function f(e){var t,n=e.name,i=e&&e.extraData&&e.extraData.extension&&e.extraData.extension.toString()||"",s=e.objectType||"",u=e.currentPage||"";switch(n){case"QueryOpen":t=r.QueryOpen;break;case"Open":t=r.OpenAction;break;case"Share":t=r.ShareAction;break;case"Sync":t=r.SyncAction;break;case"Download":t=r.DownloadAction;break;case"Delete":t=r.DeleteAction;break;case"Action.LaunchMoveCopyPanel.UseFolderSelectUX.Move":t=r.MoveAction;break;case"Action.LaunchMoveCopyPanel.UseFolderSelectUX.Copy":t=r.CopyAction;break;case"SuggestedSite.Click":t=r.SharedLibraryClick;break;case"Sites.CreateGroup.Click":t=r.CreateSharedLibrary;break;case"AllPhotos.FirstLoadInitializeAllPhotosGallery":t=r.PhotoTabClick}if(t){(function(e){o.setValue("NPSMetadataBeforeSurvey",e)})({actionName:t,extension:i,currentPage:u,objectType:s})}}},"3479":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(7),s=n(975),o=n(24),u=n(4),a=n(27),f=n(25),l=n(408),c=n(60),h=n(1183),p=n(15),d=n(6),v=n(8),m=n(708),g=n(1742),y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(p.ye);n._panelProvider=n.resources.consume(l.e);n._engagement=n.resources.consume(c.e);n._actionMap=n.resources.consume(d.e);n._selectionHelper=new(n.child(m.e))({canFallback:!1,allowMultiSelect:!0});return n}t.prototype.launchPanel=function(e,t){return Object(r.__awaiter)(this,void 0,o.n,function(){var i,s,o,f,l,c,h,p,d,m,y,b,w,E,S,x=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:this._logEngagement(e,t);i=this._selectionHelper.currentItem.peek();s=this.observables.create({items:e,parentKey:i.key,targetId:null,targetKey:null,cid:this._urlDataSource.getOwnerId(),group:i.isGroup?1:0,isAsync:!1,isMove:t});o=t?v.e.moveItemDialogTitle:v.e.copyItemDialogTitle;f=t?v.e.moveItemsDialogTitle:v.e.copyItemsDialogTitle;l=1===e.length?o:f;c=Object(u.isFeatureEnabled)(u.MoveCopyFolderSelectionUX);h=Object(u.isFeatureEnabled)(u.EnableModernMoveCopyPicker);p=h?"Action.LaunchMoveCopyPanel.ModernMoveCopyPicker":c?"Action.LaunchMoveCopyPanel.UseFolderSelectUX":"Action.LaunchMoveCopyPanel.UseFolderTreeUX";d={name:p+=t?".Move":".Copy",extraData:{ItemCount:null!==e?e.length:0}};this._engagement.logData(d);Object(g.n)(d);m={context:s,onComplete:function(){S.state(1)},isMove:t};y=h?{title:l,itemKey:i.key,isMove:t,cancel:function(){S.state(1)},complete:function(e){s().targetKey=e?e[0].key:void 0;s().targetId=e?x._getTargetId(e[0]):void 0;new(x.managed(x._actionMap.MoveCopyAction))(m).execute({})}}:{context:s,onComplete:function(){S.state(1)},title:l,resources:this.resources};return h?[4,n.e("335").then(n.bind(null,3437))]:[3,2];case 1:w=r.sent().default.tagName;return[3,7];case 2:return c?[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("262")]).then(n.bind(null,3376))]:[3,4];case 3:E=r.sent().default.tagName;return[3,6];case 4:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("263")]).then(n.bind(null,3394))];case 5:E=r.sent().default.tagName;r.label=6;case 6:w=E;r.label=7;case 7:b=w;return[2,(S=this._panelProvider.requestPanel({hasCommandBar:!c,scrollMode:c?"hidden":"auto",noTitle:!0,title:l,showCloseButton:!h,component:{name:b,params:y}})).wait().then(function(){return{resultType:a.e.Success}})]}})})};t.prototype._getTargetId=function(e){return Object(f.p)(e.key).id};t.prototype._logEngagement=function(e,t){var n=this._engagement,r=e.filter(function(e){return h.e.isShortcutItem(e)}).length;r>0&&(t?n.logData({name:"ShortcutLink.MoveInitiateAggregate",extraData:{count:r}}):n.logData({name:"ShortcutLink.CopyInitiateAggregate",extraData:{count:r}}))};return t})(i.n),b=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._isMove=t.isMove;n._selectionHelper=t.selectionHelper;n._itemReedemer=n.resources.consume(s.e);n._launchMoveCopyPanelHelper=new(n.managed(y));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._itemReedemer.redeemItems(t,e).then(function(){return e._launchMoveCopyPanelHelper.launchPanel(t,e._isMove)})})};return t})(i.n);t.default=b}}]);