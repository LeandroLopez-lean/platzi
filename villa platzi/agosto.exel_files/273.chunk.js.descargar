(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["273"],{"1736":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("searchBoxConfig")},"1928":function(e,t,n){"use strict";var r=n(0),i=n(42),s=n(111),o=(function(){function e(){this._listeners=[]}e.prototype.readData=function(){return this._data};e.prototype.listen=function(e){var t=this;this._listeners.indexOf(e)<0&&this._listeners.push(e);return function(){var n=t._listeners.indexOf(e);n>=0&&t._listeners.splice(n,1)}};e.prototype.setData=function(e){this._data=this._data||{};var t=Object(s.n)(this._data,e);this._data=t;for(var n=0,r=this._listeners;n<r.length;n++){(0,r[n])(this._data)}};e.prototype.refresh=function(){};return e})(),u=n(3),a=n(5);n.d(t,"e",function(){return p});var f={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},l={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},c=new u.t({name:"ResponsiveUI.breakpoints",factory:new u.e(l)}),h=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this)||this;r._onContainerResize=function(e){var t=r._containerElement,n=document.body,i=document.documentElement,s=t.clientWidth||i.clientWidth||t.innerWidth||n.clientWidth,o=t.clientHeight||i.clientHeight||t.innerHeight||n.clientHeight,u=r._computeFormFactorSize(r._breakpoints,s),a=r._computeCssClass(u),f=r._computeShowLabels(u),c=r._computeIsHamburgerVisible(s),h=r._computeIsScopingControlVisible(s),p={DEFAULT_BREAKPOINTS:l,MAC_SCROLL_BAR_WIDTH:8,windowWidth:s,windowHeight:o,formFactorSize:u,showLabels:f,isHamburgerVisible:c,isScopingControlVisible:h,cssClass:a};r.setData(p)};var s=t.containerElement,o=void 0===s?window:s,u=n.breakpoints;r._containerElement=o;r._breakpoints=u;r._event=new i.t(r);r._event.on(r._containerElement,"resize, orientationchange",r._onContainerResize);r._onContainerResize();return r}Object.defineProperty(t.prototype,"metrics",{get:function(){return this.readData()},enumerable:!1,configurable:!0});t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};t.determineWindowSize=function(e,t){void 0===t&&(t=l);if(0===e)return"Medium";for(var n in l)if(e<t[n])return n};t.determineCssClass=function(e){return f[e]};t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};t.prototype.compareSize=function(e,t){var n=this._breakpoints;return n[e]-n[t]};t.prototype._computeFormFactorSize=function(e,n){return this._containerElement===window?t.determineWindowSize(n,e):"Medium"};t.prototype._computeCssClass=function(e){return t.determineCssClass(e)};t.prototype._computeShowLabels=function(e){return this.compareSize(e,"Medium")>0};t.prototype._computeIsHamburgerVisible=function(e){return e<l.Large};t.prototype._computeIsScopingControlVisible=function(e){return e>l.Large};t.dependencies={breakpoints:c};return t})(o),p=Object(a.s)("ResponsiveUI",h)},"2366":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("searchBoxDataSource")},"3412":function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(413),o=n(137),u=n(27),a=n(3),f=n(5),l=n(69),c=n(49),h=function(){var e,t,n;r||(r=null===(n=null===(t=null===(e=window.mssearchux)||void 0===e?void 0:e.header)||void 0===t?void 0:t.getInstrumenter)||void 0===n?void 0:n.call(t));return r},p=function(e,t){var n,r,i=t||v(),s=e||m().activeScopeId;try{for(var o=Object(c.u)(i||[]),u=o.next();!u.done;u=o.next()){var a=u.value;if(a.id===s)return a}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},d=function(e,t){var n;t&&(r=t);var i=h();i&&i.setProps({hostAppInfo:Object(c.e)(Object(c.e)({},i.props.hostAppInfo),{scopeId:null===(n=p(e.activeScopeId,e.scopes))||void 0===n?void 0:n.searchBoxScopeId}),scopingControl:Object(c.e)({},e)})},v=function(){var e;return null===(e=m())||void 0===e?void 0:e.scopes},m=function(){var e;return null===(e=h())||void 0===e?void 0:e.props.scopingControl};var g=n(1736),y=new a.t("scopingControlDataSource"),b=n(2366),w=n(365),E=(w.e.CurrentFolderSearchScope,w.e.CurrentListSearchScope,{id:"spDocLibFolder",name:w.e.CurrentFolderSearchScope}),S={id:"spDocLib",name:w.e.CurrentLibrarySearchScope},x=(w.e.CurrentSiteSearchScope,{id:"spHubSite",name:w.e.CurrentHubSearchScope}),T=(w.e.AllSitesInHubSearchScope,{id:"spHubHub",name:w.e.CurrentHubAndAllSitesSearchScope}),N={id:"org",name:w.e.WholeOrgSearchScope};s.t.isActivated("b61d6d21-1f5a-4e5c-9770-ae749a023592","12/08/2020",'Support "All sites in hub" search scope in hub.')?[T,N]:[x,T,N];var C,k=n(60),L=n(13),A=n(1928),O=n(521),M=n(398),_=n(23);function D(){C||(C=O.n.isFeatureEnabled({ODB:1804})||(e=window._spPageContextInfo)&&!_.e.isActivated("1166a987-eb1e-4f42-baf6-46d50b7fc0c4","09/30/2020","[stvikenv] Activate this kill switch to pause experiment 90065 - using the PFP loading pattern in the search box.")&&1===Object(M.n)(90065,e)?"pfp":"eager");var e;return C}var P=n(432),H=new a.t("metadataSearchDataSource");n.d(t,"resourceKey",function(){return j});var B=(function(){function e(e,t){this._isConfigured=!1;this._resources=t.resources;this._engagement=t.engagement;this._searchBoxDataSource=t.searchBoxDataSource;this._config=t.searchBoxConfig;this._scope=new l.e;this._getViewParams=function(){throw new Error("Search box not configured")};this._isLastPageSearch=!1;this._searchInstrumenter=this._config.getInstrumenter();this._scopingControlDataSource=t.scopingControlDataSource;this._responsiveUI=t.responsiveUI;this._metadataSearchDataSource=t.metadataSearchDataSource;this._isScopingControlVisible=this._responsiveUI.metrics.isScopingControlVisible;this._bootOptions=t.bootOptions}e.prototype.configureSearchBox=function(e){var t=this;if(this._config.isEnabled()){var n=new o.e({name:"SuiteNavSearchBox.Configure"});if(this._shouldFixRaceConditions()){this._getViewParams=e;this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage()}this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.OnHasMember("Search",function(){var r,o,a,f,l=e.Search;s.t.isActivated("d7ba218a-7001-4124-8c39-109553425542","06/18/2021","overwrite search result page search box text.")?Object(L.Ci)(L.on)||l.SetSearchText(t._config.getSearchText()):Object(L.Ci)(L.on)&&!(null===(r=t._metadataSearchDataSource)||void 0===r?void 0:r.isMetadataSearchResultPage())||l.SetSearchText(t._config.getSearchText());l.SetPlaceholderText(t._config.getPlaceholderText());l.SetTokenProviders(t._searchBoxDataSource.getTokenProviders());var c=l.OnSubmitSearch(t._onSubmitSearchCallback.bind(t)),h=l.OnSearchBoxActivated(t._onSearchBoxActivatedCallback.bind(t)),p=l.OnSearchBoxDeactivated(t._onSearchBoxDeactivatedCallback.bind(t));t._trackHandler(c,l.RemoveOnSubmitSearch);t._trackHandler(h,l.RemoveOnSearchBoxActivated);t._trackHandler(p,l.RemoveOnSearchBoxDeactivated);if(Object(L.Ci)(L.S)){var d=l.OnExitSearch(t._onExitSearchCallback.bind(t));t._trackHandler(d,l.RemoveOnExitSearch)}t._searchBoxDataSource.getProviderConfigUpdaters&&l.SetProviderConfigUpdaters(t._searchBoxDataSource.getProviderConfigUpdaters(null===(o=t._scopingControlDataSource)||void 0===o?void 0:o.getActiveScope.bind(t._scopingControlDataSource)));(Object(L.Ci)(L.on)||Object(L.Ci)(L.vn))&&(t._shouldDisableSetSearchBoxSettingsInChromeless()&&(null===(a=t._bootOptions)||void 0===a?void 0:a.chromeless)&&!(null===(f=t._bootOptions)||void 0===f?void 0:f.isListHome)||l.SetSearchBoxSettings(Object(i.__assign)({cache:void 0,instrumenter:t._config.getInstrumenter(),tokenProviders:t._config.getTokenProviders()},s.t.isActivated("8852ae00-f7e0-4a74-bf2e-f5f33e61fde7","09/30/2020","[stvikenv] Specify search box loading pattern in SetSearchBoxSettings in odsp-next.")?{}:{loadingPattern:D()})));t._updateSearchInstrumenter();n.end({resultType:u.e.Success})})}).catch(function(e){n.end({resultType:u.e.Failure,error:e.message,resultCode:"getO365ShellError"})})}).catch(function(e){n.end({resultType:u.e.Failure,error:e.message,resultCode:"getSuiteNavProviderError"})});this._shouldFixRaceConditions()||(this._getViewParams=e);this._updateSearchInstrumenter();this._shouldFixRaceConditions()||s.t.isActivated("63b61692-3a0f-4f26-aec8-6045f59818bf","2020/08/14","Update last search page result.")||(this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage());this._shouldFixRaceConditions()&&(this._isConfigured=!0)}};e.prototype.updateSearchBoxConfiguration=function(e){if(this._shouldFixRaceConditions()){var t=new o.e({name:"SuiteNavSearchBox.UpdateSearchBoxConfiguration"});if(this._isConfigured)try{this._resetSearchBoxText();this._updateSearchInstrumenter();t.end({resultType:u.e.Success})}catch(e){t.end({resultType:u.e.Failure,error:e,resultCode:"RuntimeError"})}else t.end({resultType:u.e.Failure,resultCode:"SearchBoxNotInitialized"})}else{this._resetSearchBoxText();this._updateSearchInstrumenter()}};e.prototype.updateScopingControlConfiguration=function(){var e=this._isScopingControlVisible!==this._responsiveUI.metrics.isScopingControlVisible;if(this._isScopeControlSupported())if(e){this._isScopingControlVisible=this._responsiveUI.metrics.isScopingControlVisible;if(this._isScopingControlVisible)d(this._scopingControlConfig,this._searchInstrumenter);else{this._scopingControlConfig=m();d({},this._searchInstrumenter)}}else{this._scopingControlConfig=this._getScopingControlConfig();this._isScopingControlVisible&&d(this._scopingControlConfig,this._searchInstrumenter)}};e.prototype.dispose=function(){this._scope.dispose()};e.prototype._shouldFixRaceConditions=function(){return!s.t.isActivated("91300abd-a1b4-41f9-a88b-264db9937e72","2020/08/28","Fix issues with updateSearchBoxConfiguration being called before configureSearchBox")};e.prototype._shouldDisableSetSearchBoxSettingsInChromeless=function(){return!s.t.isActivated("4385e4cc-3ff4-4707-a6b7-ca36740100a0","2020/11/12","Disable SetSearchBoxSettings when chromeless")};e.prototype._runInShellSearch=function(e){return this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){return e.getO365Shell()}).then(function(t){t.OnHasMember("Search",function(){return e(t.Search)})})};e.prototype._resetSearchBoxText=function(e){var t=this,n=this._searchBoxDataSource.isSearchResultsPage(),r=Object(L.Ci)(L.on);this._config.isEnabled()&&this._runInShellSearch(function(e){(!r||n||t._isLastPageSearch)&&e.SetSearchText(t._config.getSearchText());e.SetPlaceholderText(t._config.getPlaceholderText());t._isLastPageSearch=n})};e.prototype._trackHandler=function(e,t){this._scope.attach({dispose:function(){return t(e)}})};e.prototype._onSubmitSearchCallback=function(e,t,n){var r,i,s;if(Object(L.Ci)(L.S)){var o=this._getViewParams();if(!this._searchBoxDataSource.isSearchResultsPage()){this._viewParamsBeforeSearch=o;this._urlBeforeSearch=window.location.href}}if(this._isScopeControlSupported()){s=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage());i=this._scopingControlDataSource.getActiveScope()}this._engagement.logData({name:"SuiteNavSearchBox.Click",isIntentional:!0,extraData:{trigger:n?"ScopingControl":"SubmitSearch",targetScope:null==i?void 0:i.id},scenario:s,privacyClassification:"optionalDiagnostic"});this._searchBoxDataSource.onSubmitSearchCallback(e,this._getViewParams,null===(r=this._scopingControlDataSource)||void 0===r?void 0:r.getActiveScope(),this._urlBeforeSearch,n);this._endQos("Click")};e.prototype._onExitSearchCallback=function(){var e,t=this;if(this._searchBoxDataSource.onExitSearchCallback){if(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode){this._metadataSearchDataSource.isMetadataSearchMode=!1;this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(t._searchBoxDataSource.getProviderConfigUpdaters())});this._updateSearchInstrumenter()}if(this._searchBoxDataSource.isSearchResultsPage()){this._engagement.logData({name:"SuiteNavSearchBox.ExitSearch",isIntentional:!0});this._searchBoxDataSource.onExitSearchCallback(this._viewParamsBeforeSearch)}}};e.prototype._onSearchBoxActivatedCallback=function(){var e;this._isScopeControlSupported()&&(e=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage()));this._engagement.logData({name:"SuiteNavSearchBox.FocusIn",isIntentional:!0,scenario:e,privacyClassification:"optionalDiagnostic",extraData:{isMetadataSearchAvailable:!!this._metadataSearchDataSource}});this._metadataSearchDataSource&&this._engagement.logData({name:"MetadataSearch.Available"});this._startQos()};e.prototype._onSearchBoxDeactivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusOut",isIntentional:!0,privacyClassification:"optionalDiagnostic"});this._endQos("FocusOut")};e.prototype._startQos=function(){this._currentQosEvent&&this._currentQosEvent.end({resultType:u.e.Failure});this._currentQosEvent=new o.e({name:"SuiteNavSearchBox.Usage"})};e.prototype._endQos=function(e){if(this._currentQosEvent){this._currentQosEvent.end({resultType:u.e.Success,resultCode:e});this._currentQosEvent=void 0}};e.prototype._updateSearchInstrumenter=function(){this._triggerSearchBoxReconfiguration();if(this._isScopeControlSupported()){s.t.isActivated("2f3bea3c-8f52-4b72-8421-541ee643978c","12/09/2020","Show scoping control for narrow window")?this.updateScopingControlConfiguration():d(this._getScopingControlConfig(),this._searchInstrumenter);var e=this._scopingControlDataSource.getInitialScope();this._scopingControlDataSource.setActiveScope(e)}this._setSearchInstrumenterProps();this._configureMetadataSearch()};e.prototype._isScopeControlSupported=function(){return!!this._scopingControlDataSource&&this._scopingControlDataSource.isScopingControlEnabled()};e.prototype._getScopingControlConfig=function(){var e=this;if(!this._isScopeControlSupported())throw new Error("Scoping control is not supported.");return{scopes:this._scopingControlDataSource.getAvailableScopes(),activeScopeId:this._scopingControlDataSource.getInitialScope().id,onChange:function(t,n){e._scopingControlDataSource.setActiveScope(n);e._triggerSearchBoxReconfiguration();var r=!!t&&e._searchBoxDataSource.isSearchResultsPage();e._logScopeChange(n,r);r?e._onSubmitSearchCallback(t,void 0,!0):e._setFocusSearchBox();e._updateMetadataSearchConfiguration()}}};e.prototype._hideScopingControl=function(){this._searchInstrumenter.setProps({scopingControl:Object(i.__assign)(Object(i.__assign)({},this._searchInstrumenter.props.scopingControl),{activeScopeId:void 0,scopes:void 0})})};e.prototype._configureMetadataSearch=function(){var e=this;if(this._metadataSearchDataSource){this._metadataSearchDataSource.updateMetadataSearchConfig=function(){e._updateMetadataSearchConfiguration();e._metadataSearchDataSource.isMetadataSearchMode?e._setFocusSearchBox():e.updateScopingControlConfiguration()};this._metadataSearchDataSource.isMetadataSearchResultPage()&&(this._metadataSearchDataSource.isMetadataSearchMode=!0);this._updateMetadataSearchConfiguration()}};e.prototype._hideMetadataSearchButton=function(){var e;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:void 0})};e.prototype._showMetadataSearchButton=function(){var e,t=this;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:{onClick:function(e){t._metadataSearchDataSource.isMetadataSearchMode=!0;t._updateMetadataSearchConfiguration();t._setFocusSearchBox();var n=e||window.event;n&&"keydown"===n.type&&setTimeout(function(){return t._setFocusSearchBox()},0)},ariaLabel:w.e.MetadataSearchHint,title:w.e.MetadataSearchHint}})};e.prototype._updateMetadataSearchConfiguration=function(){var e=this,t=this._scopingControlDataSource.getActiveScope(),n=t===S||t===E;this._runInShellSearch(function(t){t.SetProviderConfigUpdaters(e._searchBoxDataSource.getProviderConfigUpdaters())});if(n)if(this._metadataSearchDataSource.isMetadataSearchMode){this._hideScopingControl();this._hideMetadataSearchButton()}else this._showMetadataSearchButton();else this._hideMetadataSearchButton()};e.prototype._setFocusSearchBox=function(){this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.Search.FocusSearchBox()})})};e.prototype._setSearchInstrumenterProps=function(){this._searchBoxDataSource.getSearchInstrumenterProps&&this._searchInstrumenter&&this._searchInstrumenter.setProps(this._searchBoxDataSource.getSearchInstrumenterProps())};e.prototype._triggerSearchBoxReconfiguration=function(){this._runInShellSearch(function(e){return e.RecomputeSearchBoxConfiguration()})};e.prototype._logScopeChange=function(e,t){if(!this._scopingControlDataSource)throw new Error("Scoping control is not supported.");var n=this._scopingControlDataSource.getInitialScope(),r=this._scopingControlDataSource.getScopeControlScenario(n,this._searchBoxDataSource.isSearchResultsPage());this._engagement.logData({name:"SuiteNavSearchBox.ScopeChanged",isIntentional:!0,scenario:r,extraData:{initialScope:n.id,targetScope:e.id,searchTriggered:t},privacyClassification:"optionalDiagnostic"})};e.dependencies={resources:a.o,engagement:k.e,searchBoxDataSource:b.e,searchBoxConfig:g.e,scopingControlDataSource:y.optional,responsiveUI:A.e,metadataSearchDataSource:H.optional,bootOptions:P.e.optional};return e})(),j=(t.default=B,Object(f.s)("SearchBoxProvider",B))}}]);